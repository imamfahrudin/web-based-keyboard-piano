<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Based Keyboard Piano</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Feature Toggles -->
  <div class="feature-toggles">
    <div class="feature-toggle" id="sheet-modal-toggle">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
        <polyline points="14 2 14 8 20 8"></polyline>
        <line x1="8" y1="13" x2="16" y2="13"></line>
        <line x1="8" y1="17" x2="16" y2="17"></line>
      </svg>
      <span>Sheet Music</span>
    </div>
    <div class="feature-toggle" id="metronome-modal-toggle">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2 L12 22 M8 6 L16 6 L14 18 L10 18 Z"></path>
      </svg>
      <span>Metronome</span>
    </div>
    <div class="feature-toggle" id="adsr-modal-toggle">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 20 L7 4 L10 12 L13 8 L16 12 L21 4"></path>
        <line x1="3" y1="20" x2="21" y2="20"></line>
      </svg>
      <span>ADSR</span>
    </div>
    <div class="feature-toggle" id="scale-modal-toggle">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 18V5l12-2v13"></path>
        <circle cx="6" cy="18" r="3"></circle>
        <circle cx="18" cy="16" r="3"></circle>
      </svg>
      <span>Scale</span>
    </div>
  </div>

  <div class="piano-container">
    <!-- Music Sheet Display (above controls) -->
    <div class="sheet-music-modal hidden" id="sheet-modal">
      <div class="modal-header">
        <h3>
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
            <line x1="8" y1="13" x2="16" y2="13"></line>
            <line x1="8" y1="17" x2="16" y2="17"></line>
          </svg>
          Sheet Music
        </h3>
        <button id="clear-sheet" class="clear-btn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"></polyline>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
          </svg>
          Clear
        </button>
      </div>
      <div class="sheet-display">
        <div class="staff-container">
          <svg class="music-staff" viewBox="0 0 800 300" preserveAspectRatio="xMidYMid meet">
            <!-- Treble Staff lines -->
            <line x1="20" y1="40" x2="780" y2="40" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="60" x2="780" y2="60" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="80" x2="780" y2="80" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="100" x2="780" y2="100" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="120" x2="780" y2="120" stroke="#333" stroke-width="1.5"/>
            
            <!-- Bass Staff lines -->
            <line x1="20" y1="180" x2="780" y2="180" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="200" x2="780" y2="200" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="220" x2="780" y2="220" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="240" x2="780" y2="240" stroke="#333" stroke-width="1.5"/>
            <line x1="20" y1="260" x2="780" y2="260" stroke="#333" stroke-width="1.5"/>
            
            <!-- Brace connecting staves -->
            <path d="M 15 35 Q 10 80 15 125 Q 10 150 15 175 Q 10 220 15 265" 
                  stroke="#333" stroke-width="2" fill="none"/>
            
            <!-- Treble clef -->
            <text x="30" y="110" font-size="80" font-family="serif" fill="#333">ùÑû</text>
            
            <!-- Bass clef -->
            <text x="30" y="245" font-size="60" font-family="serif" fill="#333">ùÑ¢</text>
            
            <!-- Notes will be added here dynamically -->
            <g id="notes-container"></g>
          </svg>
        </div>
        <div class="sheet-info">
          <p>Play notes on the piano to see them appear on the staff</p>
        </div>
      </div>
    </div>

    <div class="controls">
      <div class="sound-control">
        <label for="sound-selector">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18V5l12-2v13"></path>
            <circle cx="6" cy="18" r="3"></circle>
            <circle cx="18" cy="16" r="3"></circle>
          </svg>
          Sound
        </label>
        <select id="sound-selector">
          <option value="Synth">Basic Synth</option>
          <option value="AMSynth">AM Synth</option>
          <option value="FMSynth">FM Synth</option>
          <option value="DuoSynth">Duo Synth</option>
          <option value="MonoSynth">Mono Synth</option>
          <option value="MembraneSynth">Membrane</option>
          <option value="MetalSynth">Metallic</option>
        </select>
      </div>
      <div class="volume-control">
        <label for="volume-slider">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
          </svg>
        </label>
        <input type="range" id="volume-slider" min="-40" max="0" value="-12" step="1">
        <span id="volume-value">-12 dB</span>
      </div>
      <div class="transpose-control">
        <label for="transpose-slider">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
          </svg>
          Transpose
        </label>
        <input type="range" id="transpose-slider" min="-6" max="6" value="0" step="1">
        <span id="transpose-value">0</span>
      </div>
    </div>
    <div class="piano" id="piano"></div>
    
    <!-- Modals Container (absolute positioning to not affect layout) -->
    <div class="modals-container">
      <!-- Metronome Modal -->
      <div class="metronome-modal hidden" id="metronome-modal">
        <div class="metronome-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2 L12 22 M8 6 L16 6 L14 18 L10 18 Z"></path>
            </svg>
            Metronome
          </h3>
          <button id="metronome-toggle" class="toggle-btn">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            <span>Start</span>
          </button>
        </div>
        <div class="metronome-controls">
          <div class="control-group">
            <label for="bpm-slider">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              Tempo
            </label>
            <input type="range" id="bpm-slider" min="40" max="240" value="120" step="1">
            <span id="bpm-value">120 BPM</span>
          </div>
          <div class="control-group">
            <label for="metronome-volume-slider">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
              </svg>
              Volume
            </label>
            <input type="range" id="metronome-volume-slider" min="-40" max="0" value="-10" step="1">
            <span id="metronome-volume-value">-10 dB</span>
          </div>
          <div class="control-group">
            <label for="time-signature">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"></rect>
                <line x1="9" y1="3" x2="9" y2="21"></line>
              </svg>
              Time Signature
            </label>
            <select id="time-signature">
              <option value="2/4">2/4</option>
              <option value="3/4">3/4</option>
              <option value="4/4" selected>4/4</option>
              <option value="5/4">5/4</option>
              <option value="6/8">6/8</option>
              <option value="7/8">7/8</option>
              <option value="9/8">9/8</option>
              <option value="12/8">12/8</option>
            </select>
          </div>
        </div>
        <div class="beat-indicator">
          <div class="beat-dot" data-beat="1"></div>
          <div class="beat-dot" data-beat="2"></div>
          <div class="beat-dot" data-beat="3"></div>
          <div class="beat-dot" data-beat="4"></div>
        </div>
      </div>

      <!-- ADSR Modal -->
      <div class="adsr-modal hidden" id="adsr-modal">
        <div class="modal-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 20 L7 4 L10 12 L13 8 L16 12 L21 4"></path>
              <line x1="3" y1="20" x2="21" y2="20"></line>
            </svg>
            ADSR Envelope
          </h3>
          <button id="adsr-reset" class="reset-btn">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
              <path d="M21 3v5h-5"></path>
              <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
              <path d="M3 21v-5h5"></path>
            </svg>
            Reset
          </button>
        </div>
        <div class="adsr-controls">
          <div class="control-group">
            <label for="attack-slider">
              <span>Attack</span>
            </label>
            <input type="range" id="attack-slider" min="0.001" max="2" value="0.001" step="0.001">
            <span id="attack-value">0.001s</span>
          </div>
          <div class="control-group">
            <label for="decay-slider">
              <span>Decay</span>
            </label>
            <input type="range" id="decay-slider" min="0" max="2" value="0" step="0.01">
            <span id="decay-value">0.00s</span>
          </div>
          <div class="control-group">
            <label for="sustain-slider">
              <span>Sustain</span>
            </label>
            <input type="range" id="sustain-slider" min="0" max="1" value="1" step="0.01">
            <span id="sustain-value">1.00</span>
          </div>
          <div class="control-group">
            <label for="release-slider">
              <span>Release</span>
            </label>
            <input type="range" id="release-slider" min="0.1" max="5" value="1.5" step="0.1">
            <span id="release-value">1.5s</span>
          </div>
        </div>
      </div>

      <!-- Scale Highlight Modal -->
      <div class="scale-modal hidden" id="scale-modal">
        <div class="modal-header">
          <h3>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18V5l12-2v13"></path>
              <circle cx="6" cy="18" r="3"></circle>
              <circle cx="18" cy="16" r="3"></circle>
            </svg>
            Scale Highlighter
          </h3>
        </div>
        <div class="scale-controls">
          <div class="control-group">
            <label for="scale-root">Root Note</label>
            <select id="scale-root">
              <option value="C">C</option>
              <option value="C#">C# / Db</option>
              <option value="D">D</option>
              <option value="D#">D# / Eb</option>
              <option value="E">E</option>
              <option value="F">F</option>
              <option value="F#">F# / Gb</option>
              <option value="G">G</option>
              <option value="G#">G# / Ab</option>
              <option value="A">A</option>
              <option value="A#">A# / Bb</option>
              <option value="B">B</option>
            </select>
          </div>
          <div class="control-group">
            <label for="scale-type">Scale Type</label>
            <select id="scale-type">
              <option value="none">None</option>
              <option value="major">Major</option>
              <option value="minor">Natural Minor</option>
              <option value="harmonic-minor">Harmonic Minor</option>
              <option value="melodic-minor">Melodic Minor</option>
              <option value="pentatonic">Pentatonic Major</option>
              <option value="pentatonic-minor">Pentatonic Minor</option>
              <option value="blues">Blues</option>
              <option value="chromatic">Chromatic</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
  <script src="piano.js"></script>
</body>
</html>